---
import WebPageBaseLayout from "../layouts/WebPageBaseLayout.astro";
import HomePageContent from "../data/pages/Home.json";
import type { HomePageData, ColorType } from "../types/home-page.data";
import { colorHoverClasses, textColors } from "../types/home-page.data";

const content = HomePageContent as HomePageData;
const { meta, workAreas, interests, techStack, cta } = content;

// Color mappings
const colorClasses: Record<ColorType, string> = {
  blue: "hover:border-blue-500",
  purple: "hover:border-purple-500",
  green: "hover:border-green-500",
  yellow: "hover:border-yellow-500",
  red: "hover:border-red-500",
  orange: "hover:border-orange-500",
  cyan: "hover:border-cyan-500",
  teal: "hover:border-teal-500",
  slate: "hover:border-slate-500",
  amber: "hover:border-amber-500",
  gray: "hover:border-gray-500",
};
---

<WebPageBaseLayout>
  <canvas
    id="neuralCanvas"
    class="fixed top-0 left-0 w-full h-full opacity-40 pointer-events-none"
  ></canvas>

  <div class="relative z-10 max-w-4xl mx-auto px-6 py-16 min-h-screen">
    <!-- Header -->
    <header class="my-20">
      <div
        class="hidden md:block text-green-400 text-sm font-mono mb-6 pulse-dot"
      >
        {meta.tagline}
      </div>

      <h1 class="text-5xl md:text-6xl font-semibold mb-6 leading-tight">
        {meta.title}
        <span
          class="text-transparent bg-clip-text bg-gradient-to-r from-blue-400 to-purple-500"
        >
          {meta.titleHighlight}
        </span>
      </h1>

      <p class="text-xl text-gray-400 max-w-2xl leading-relaxed">
        {meta.description}
      </p>
    </header>

    <!-- What I Do -->
    <section class="mb-20">
      <h2 class="text-2xl font-semibold mb-8 text-gray-300">What I work on</h2>

      <div class="grid md:grid-cols-2 gap-6">
        {
          workAreas.map((area) => (
            <div
              class={`bg-gray-900 border border-gray-800 rounded-lg p-6 ${colorClasses[area.color]} transition-colors duration-300`}
            >
              <div class="text-3xl mb-4">{area.emoji}</div>
              <h3 class="text-lg font-semibold mb-2">{area.title}</h3>
              <p class="text-gray-400 text-sm leading-relaxed">
                {area.description}
              </p>
            </div>
          ))
        }
      </div>
    </section>

    <!-- Interests -->
    <section class="mb-20">
      <h2 class="text-2xl font-semibold mb-8 text-gray-300">
        Current interests
      </h2>

      <div class="space-y-4">
        {
          interests.map((interest) => (
            <div class="bg-gray-900/50 border border-gray-800 rounded-lg p-5">
              <h3 class={`font-semibold mb-2 ${textColors[interest.color]}`}>
                {interest.title}
              </h3>
              <p class="text-gray-400 text-sm">{interest.description}</p>
            </div>
          ))
        }
      </div>
    </section>

    <!-- Stack -->
    <section class="mb-20">
      <h2 class="text-2xl font-semibold mb-8 text-gray-300">Tech Stack</h2>
      <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
        <!-- Languages -->
        <div
          class="bg-gray-900/50 border border-gray-800 rounded-lg p-5 hover:border-gray-700 transition-colors"
        >
          <h3
            class="text-sm font-semibold text-gray-300 mb-4 flex items-center gap-2"
          >
            <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
              <path d="M13 7H7v6h6V7z"></path>
              <path
                fill-rule="evenodd"
                d="M7 2a1 1 0 012 0v1h2V2a1 1 0 112 0v1h2a2 2 0 012 2v2h1a1 1 0 110 2h-1v2h1a1 1 0 110 2h-1v2a2 2 0 01-2 2h-2v1a1 1 0 11-2 0v-1H9v1a1 1 0 11-2 0v-1H5a2 2 0 01-2-2v-2H2a1 1 0 110-2h1V9H2a1 1 0 010-2h1V5a2 2 0 012-2h2V2zM5 5h10v10H5V5z"
                clip-rule="evenodd"></path>
            </svg>
            Languages
          </h3>
          <div class="flex flex-wrap gap-2">
            {
              techStack.languages.map((lang) => (
                <a
                  href={lang.url}
                  target="_blank"
                  class={`group px-3 py-1.5 bg-gray-800/50 border border-gray-700 rounded-full text-xs ${colorHoverClasses[lang.color]} transition-all flex items-center gap-1.5`}
                >
                  <span class={textColors[lang.color]}>{lang.icon}</span>{" "}
                  {lang.name}
                </a>
              ))
            }
          </div>
        </div>

        <!-- Runtimes -->
        <div
          class="bg-gray-900/50 border border-gray-800 rounded-lg p-5 hover:border-gray-700 transition-colors"
        >
          <h3
            class="text-sm font-semibold text-gray-300 mb-4 flex items-center gap-2"
          >
            <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
              <path
                fill-rule="evenodd"
                d="M11.3 1.046A1 1 0 0112 2v5h4a1 1 0 01.82 1.573l-7 10A1 1 0 018 18v-5H4a1 1 0 01-.82-1.573l7-10a1 1 0 011.12-.38z"
                clip-rule="evenodd"></path>
            </svg>
            Runtimes
          </h3>
          <div class="flex flex-wrap gap-2">
            {
              techStack.runtimes.map((runtime) => (
                <a
                  href={runtime.url}
                  target="_blank"
                  class={`group px-3 py-1.5 bg-gray-800/50 border border-gray-700 rounded-full text-xs ${colorHoverClasses[runtime.color]} transition-all flex items-center gap-1.5`}
                >
                  <span class={textColors[runtime.color]}>{runtime.icon}</span>{" "}
                  {runtime.name}
                </a>
              ))
            }
          </div>
        </div>

        <!-- Backend Frameworks -->
        <div
          class="bg-gray-900/50 border border-gray-800 rounded-lg p-5 hover:border-gray-700 transition-colors"
        >
          <h3
            class="text-sm font-semibold text-gray-300 mb-4 flex items-center gap-2"
          >
            <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
              <path
                d="M2 6a2 2 0 012-2h5l2 2h5a2 2 0 012 2v6a2 2 0 01-2 2H4a2 2 0 01-2-2V6z"
              ></path>
            </svg>
            Backend Frameworks
          </h3>
          <div class="flex flex-wrap gap-2">
            {
              techStack.backendFrameworks.map((framework) => (
                <a
                  href={framework.url}
                  target="_blank"
                  class={`group px-3 py-1.5 bg-gray-800/50 border border-gray-700 rounded-full text-xs ${colorHoverClasses[framework.color]} transition-all flex items-center gap-1.5`}
                >
                  <span class={textColors[framework.color]}>
                    {framework.icon}
                  </span>{" "}
                  {framework.name}
                </a>
              ))
            }
          </div>
        </div>

        <!-- Frontend Frameworks -->
        <div
          class="bg-gray-900/50 border border-gray-800 rounded-lg p-5 hover:border-gray-700 transition-colors"
        >
          <h3
            class="text-sm font-semibold text-gray-300 mb-4 flex items-center gap-2"
          >
            <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
              <path
                fill-rule="evenodd"
                d="M3 5a2 2 0 012-2h10a2 2 0 012 2v8a2 2 0 01-2 2h-2.22l.123.489.804.804A1 1 0 0113 18H7a1 1 0 01-.707-1.707l.804-.804L7.22 15H5a2 2 0 01-2-2V5zm5.771 7H5V5h10v7H8.771z"
                clip-rule="evenodd"></path>
            </svg>
            Frontend Frameworks
          </h3>
          <div class="flex flex-wrap gap-2">
            {
              techStack.frontendFrameworks.map((framework) => (
                <a
                  href={framework.url}
                  target="_blank"
                  class={`group px-3 py-1.5 bg-gray-800/50 border border-gray-700 rounded-full text-xs ${colorHoverClasses[framework.color]} transition-all flex items-center gap-1.5`}
                >
                  <span class={textColors[framework.color]}>
                    {framework.icon}
                  </span>{" "}
                  {framework.name}
                </a>
              ))
            }
          </div>
        </div>

        <!-- Machine Learning -->
        <div
          class="bg-gray-900/50 border border-gray-800 rounded-lg p-5 hover:border-gray-700 transition-colors md:col-span-2"
        >
          <h3
            class="text-sm font-semibold text-gray-300 mb-4 flex items-center gap-2"
          >
            <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
              <path d="M13 7H7v6h6V7z"></path>
              <path
                fill-rule="evenodd"
                d="M10 18a8 8 0 100-16 8 8 0 000 16zM9.555 7.168A1 1 0 008 8v4a1 1 0 001.555.832l3-2a1 1 0 000-1.664l-3-2z"
                clip-rule="evenodd"></path>
            </svg>
            Machine Learning & Data Science
          </h3>
          <div class="flex flex-wrap gap-2">
            {
              techStack.machineLearning.map((tool) => (
                <a
                  href={tool.url}
                  target="_blank"
                  class={`group px-3 py-1.5 bg-gray-800/50 border border-gray-700 rounded-full text-xs ${colorHoverClasses[tool.color]} transition-all flex items-center gap-1.5`}
                >
                  <span class={textColors[tool.color]}>{tool.icon}</span>{" "}
                  {tool.name}
                </a>
              ))
            }
          </div>
        </div>
      </div>
    </section>

    <!-- CTA -->
    <section class="mb-20">
      <div
        class="bg-gradient-to-r from-blue-900/30 to-purple-900/30 border border-blue-500/30 rounded-lg p-8"
      >
        <h2 class="text-2xl font-semibold mb-4">{cta.title}</h2>
        <p class="text-gray-400 mb-6 leading-relaxed">
          {cta.description}
        </p>
        <div class="flex flex-wrap gap-4">
          {
            cta.buttons.map((button) => (
              <a
                href={button.url}
                class={`px-6 py-3 ${button.variant === "primary" ? "bg-blue-600 hover:bg-blue-700" : "bg-gray-800 hover:bg-gray-700 border border-gray-700"} rounded-lg transition-colors duration-200 font-medium`}
                target={button.target || "_self"}
              >
                {button.text}
              </a>
            ))
          }
        </div>
      </div>
    </section>
  </div>

  <!-- The JavaScript for neural canvas remains the same -->
  <script is:inline>
    const canvas = document.getElementById("neuralCanvas");
    const ctx = canvas.getContext("2d");

    canvas.width = window.innerWidth;
    canvas.height = window.innerHeight;

    const nodes = [];
    const nodeCount = 50;
    const connectionDistance = 150;

    class Node {
      constructor() {
        this.x = Math.random() * canvas.width;
        this.y = Math.random() * canvas.height;
        this.vx = (Math.random() - 0.5) * 0.5;
        this.vy = (Math.random() - 0.5) * 0.5;
        this.radius = 2;
      }

      update() {
        this.x += this.vx;
        this.y += this.vy;

        if (this.x < 0 || this.x > canvas.width) this.vx *= -1;
        if (this.y < 0 || this.y > canvas.height) this.vy *= -1;
      }

      draw() {
        ctx.beginPath();
        ctx.arc(this.x, this.y, this.radius, 0, Math.PI * 2);
        ctx.fillStyle = "#3b82f6";
        ctx.fill();
      }
    }

    for (let i = 0; i < nodeCount; i++) {
      nodes.push(new Node());
    }

    function drawConnections() {
      for (let i = 0; i < nodes.length; i++) {
        for (let j = i + 1; j < nodes.length; j++) {
          const dx = nodes[i].x - nodes[j].x;
          const dy = nodes[i].y - nodes[j].y;
          const distance = Math.sqrt(dx * dx + dy * dy);

          if (distance < connectionDistance) {
            ctx.beginPath();
            ctx.moveTo(nodes[i].x, nodes[i].y);
            ctx.lineTo(nodes[j].x, nodes[j].y);
            ctx.strokeStyle = `rgba(59, 130, 246, ${1 - distance / connectionDistance})`;
            ctx.lineWidth = 0.5;
            ctx.stroke();
          }
        }
      }
    }

    function animate() {
      ctx.clearRect(0, 0, canvas.width, canvas.height);

      drawConnections();

      nodes.forEach((node) => {
        node.update();
        node.draw();
      });

      requestAnimationFrame(animate);
    }

    animate();

    window.addEventListener("resize", () => {
      canvas.width = window.innerWidth;
      canvas.height = window.innerHeight;
    });
  </script>
</WebPageBaseLayout>
